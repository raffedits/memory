<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON MEMORY - Cyber Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --blu-neon: #00d2ff;
            --rosso-neon: #ff0055;
            --sfondo-dark: #0a0b10;
            --testo-chiaro: #e0e0e0;
            --shadow-blu: 0 0 15px var(--blu-neon);
            --shadow-rosso: 0 0 15px var(--rosso-neon);
        }

        body, html {
            margin: 0; padding: 0;
            font-family: 'Rajdhani', sans-serif;
            background-color: var(--sfondo-dark);
            color: var(--testo-chiaro);
            height: 100vh; width: 100vw;
            display: flex; justify-content: center; align-items: center;
            overflow: hidden;
        }

        body::before {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1b2735 0%, #090a0f 100%);
            z-index: -1;
        }

        .screen {
            position: absolute;
            width: 100%; height: 100%;
            display: none; flex-direction: column;
            justify-content: center; align-items: center;
            text-align: center; padding: 20px; box-sizing: border-box;
        }

        .screen.active { display: flex; }

        h1 { font-family: 'Orbitron', sans-serif; font-size: clamp(2rem, 8vw, 3.5rem); margin-bottom: 1rem; letter-spacing: 5px; }

        .btn {
            padding: 12px 30px; font-family: 'Orbitron', sans-serif;
            font-size: 0.9rem; font-weight: bold; text-transform: uppercase;
            background: transparent; color: var(--blu-neon);
            border: 2px solid var(--blu-neon); cursor: pointer;
            transition: 0.3s; clip-path: polygon(10% 0, 100% 0, 90% 100%, 0 100%);
            margin: 10px; min-width: 180px;
        }
        .btn:hover { background: var(--blu-neon); color: #000; box-shadow: var(--shadow-blu); }
        .btn-red { color: var(--rosso-neon); border-color: var(--rosso-neon); }
        .btn-red:hover { background: var(--rosso-neon); box-shadow: var(--shadow-rosso); }

        /* --- GRIGLIA MEMORY --- */
        .game-info {
            display: flex; gap: 20px; margin-bottom: 15px;
            font-family: 'Orbitron', sans-serif; font-size: 1.1rem;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            perspective: 1000px;
        }

        .card {
            width: clamp(60px, 18vw, 85px);
            height: clamp(80px, 25vw, 110px);
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .card.flipped { transform: rotateY(180deg); }

        .card-face {
            position: absolute;
            width: 100%; height: 100%;
            backface-visibility: hidden;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; border-radius: 8px; border: 2px solid rgba(255,255,255,0.1);
        }

        .card-front {
            background: #1a1c2c;
            color: var(--blu-neon);
            box-shadow: inset 0 0 15px rgba(0,0,0,0.5);
        }

        .card-front::after { content: "?"; opacity: 0.3; }

        .card-back {
            background: #2a2f4a;
            transform: rotateY(180deg);
            border-color: var(--blu-neon);
        }

        .matched .card-back {
            border-color: #00ff88;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.4);
        }

        #turn-msg { font-size: 1.4rem; margin-bottom: 10px; text-transform: uppercase; }
    </style>
</head>
<body>

    <div id="menu-screen" class="screen active">
        <h1>NEON MEMORY</h1>
        <button class="btn" onclick="showScreen('mode-screen')">AVVIA SISTEMA</button>
    </div>

    <div id="mode-screen" class="screen">
        <h2>IDENTIFICA UTENTE</h2>
        <button class="btn" onclick="startGame(false)">Due Giocatori</button>
        <button class="btn btn-red" onclick="startGame(true)">Contro il Bot</button>
    </div>

    <div id="game-screen" class="screen">
        <div id="turn-msg">TURNO DI: <span id="current-player-name">BLU</span></div>
        <div class="game-info">
            <span style="color:var(--blu-neon)">BLU: <span id="score-0">0</span></span>
            <span style="color:var(--rosso-neon)">ROSSO: <span id="score-1">0</span></span>
        </div>
        <div class="memory-grid" id="grid"></div>
        <button class="btn btn-red" style="margin-top:20px; padding:8px;" onclick="showScreen('menu-screen')">EXIT</button>
    </div>

    <div id="win-screen" class="screen">
        <h1 id="win-text">IL BLU HA VINTO</h1>
        <button class="btn" onclick="resetGame()">REBOOT</button>
    </div>

    <script>
        const symbols = ['◈', '▣', '▲', '✚', '◆', '❖', '⬢', '⬟'];
        let cards = [...symbols, ...symbols];
        let flippedCards = [];
        let scores = [0, 0];
        let currentPlayer = 0;
        let isBotMode = false;
        let canFlip = true;

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            setTimeout(() => {
                document.querySelectorAll('.screen').forEach(s => s.style.display = 'none');
                const target = document.getElementById(screenId);
                target.style.display = 'flex';
                setTimeout(() => target.classList.add('active'), 50);
            }, 400);
        }

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function startGame(bot) {
            isBotMode = bot;
            scores = [0, 0];
            currentPlayer = 0;
            canFlip = true;
            document.getElementById('score-0').innerText = "0";
            document.getElementById('score-1').innerText = "0";
            updateUI();
            createGrid();
            showScreen('game-screen');
        }

        function createGrid() {
            const grid = document.getElementById('grid');
            grid.innerHTML = "";
            shuffle(cards);
            cards.forEach((symbol, index) => {
                const card = document.createElement('div');
                card.className = 'card';
                card.dataset.symbol = symbol;
                card.dataset.index = index;
                card.innerHTML = `
                    <div class="card-face card-front"></div>
                    <div class="card-face card-back">${symbol}</div>
                `;
                card.onclick = () => flipCard(card);
                grid.appendChild(card);
            });
        }

        function flipCard(card) {
            if (!canFlip || card.classList.contains('flipped') || flippedCards.length >= 2) return;

            card.classList.add('flipped');
            flippedCards.push(card);

            if (flippedCards.length === 2) {
                canFlip = false;
                checkMatch();
            }
        }

        function checkMatch() {
            const [c1, c2] = flippedCards;
            const match = c1.dataset.symbol === c2.dataset.symbol;

            if (match) {
                scores[currentPlayer]++;
                document.getElementById(`score-${currentPlayer}`).innerText = scores[currentPlayer];
                c1.classList.add('matched');
                c2.classList.add('matched');
                flippedCards = [];
                
                if (scores[0] + scores[1] === symbols.length) {
                    setTimeout(endGame, 1000);
                } else {
                    canFlip = true;
                    if (currentPlayer === 1 && isBotMode) setTimeout(botMove, 1000);
                }
            } else {
                setTimeout(() => {
                    c1.classList.remove('flipped');
                    c2.classList.remove('flipped');
                    flippedCards = [];
                    currentPlayer = currentPlayer === 0 ? 1 : 0;
                    updateUI();
                    canFlip = true;
                    if (currentPlayer === 1 && isBotMode) setTimeout(botMove, 1000);
                }, 1000);
            }
        }

        function updateUI() {
            const name = currentPlayer === 0 ? "BLU" : "ROSSO";
            const color = currentPlayer === 0 ? "var(--blu-neon)" : "var(--rosso-neon)";
            const display = document.getElementById('current-player-name');
            display.innerText = name;
            display.style.color = color;
            display.style.textShadow = currentPlayer === 0 ? "var(--shadow-blu)" : "var(--shadow-rosso)";
        }

        function botMove() {
            if (!canFlip) return;
            const unflipped = [...document.querySelectorAll('.card:not(.flipped)')];
            if (unflipped.length < 2) return;

            // Il bot sceglie due carte a caso (simula intelligenza base)
            const r1 = Math.floor(Math.random() * unflipped.length);
            flipCard(unflipped[r1]);
            
            const remaining = [...document.querySelectorAll('.card:not(.flipped)')];
            const r2 = Math.floor(Math.random() * remaining.length);
            setTimeout(() => flipCard(remaining[r2]), 800);
        }

        function endGame() {
            const winTxt = document.getElementById('win-text');
            if (scores[0] === scores[1]) {
                winTxt.innerText = "NESSUNO HA VINTO";
                winTxt.style.color = "#fff";
            } else {
                const winner = scores[0] > scores[1] ? "IL BLU" : "IL ROSSO";
                winTxt.innerText = `${winner} HA VINTO`;
                winTxt.style.color = scores[0] > scores[1] ? "var(--blu-neon)" : "var(--rosso-neon)";
            }
            showScreen('win-screen');
        }

        function resetGame() {
            startGame(isBotMode);
        }
    </script>
</body>
</html>
